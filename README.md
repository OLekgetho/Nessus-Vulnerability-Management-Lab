# Nessus-Vulnerability-Management-Lab

## Description

This is a walkthrough of how I created a virtual machine environment using VMware, running Windows 10 and Kali Linux. I undertook this project to gain hands-on experience with Nessus Essentials, focusing on host discovery, vulnerability scanning, and remediation. I first used Nessus to conduct a host discovery to identify which devices are active on the network. Then, I ran three basic network scans with different configurations:
- Normal Basic Network Scan.
- Basic Network Scan with Credentials Provided.
- Basic Network Scan After Remediation Has Been Completed.

## Environments Used
- VMware
- Kali Linux
- Windows 10

## Project Walkthrough
### _Host Discovery_
  
The first thing I wanted to do was discover which devices were active on the network and identify their IP addresses. While I could have simply checked the IP address of the Windows machine using the CMD and typing "ipconfig," I found it more enjoyable to use Nessus to locate the IPv4 address and identify the open ports on the device. So the first thing I click the button on the top right corner that says "New Scan".

![Homepage Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173256.png)

After clicking the button it navigated me to the Scan Templates. So here I clicked the option "Host Discovery" under the Discovery section.

![Scan Templates Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173321.png)

After clicking the option, I needed to fill in some information to run the scan. The required details included a name and the target. For the target, I entered a CIDR notation to reveal all active devices within that IP range, specifically from 192.168.64.0 to 192.168.64.255.

![Host Discovery Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173825.png)

Then I moved to the next section, which is Discovery, and I left it set to the default option, "Host Enumeration.". To determine if a device is active, it will ping it in three ways: TCP, ARP, and ICMP.

![Host Discovery Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173854.png)

After that I clicked the save button at the bottom to save the scan. To start the scan I clicked the launch button which is the play icon on the right next to the red cross.

![Host Discovery Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173951.png)

I clicked the scan to see if it is running and I could see it on the right at the Scan Details that the status says "Running".

![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20174018.png)

After the scan was done I went to the Host tab to see which hosts were active and I saw that the was 4 hosts active but IP 192.168.64.1 and 192.168.64.254 they could be a Gateway and a Router so it came down to the other two devices and I knew that the kali linux ip is 192.168.64.128 so the Windows IP address was 192.168.64.132 and also because of port 139 it confirms that it is a Windows as this port is primarily used by the Server Message Block (SMB) protocol for file sharing in Windows networks.

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20174302.png)

### _Normal Basic Network Scan_
  
So now as I have found the IP address for my Windows Machine I can now begin the Basic Network scan to identify potential security vulnerabilities. So now I create a new scan and then I now choose "Basic Network Scan" option. 

![Scan Templates Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173321.png)

After clicking the option, I needed to fill in some information to run the scan similar like the Host Discovery but this time as I know my target I just specified the target which is 192.168.64.132. 

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20174847.png)

Then I moved to the next sub section, which is Schedule so if I needed to do this for a organizaion I would perform the scan every week on a sunday at 6 am so the schedule option would look like this.

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175040.png)

But as I don't need to do so I am going to go back to the default option which is to switch is not to turn of the schedule option.

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175055.png)

Then I moved to the next section, which is Discovery. I left it set to the default option, "Port scan (common port)".

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175133.png)

After the Discovery section I moved to the next section which is Assessment I also left it set to the default option which will avoid potential fake alarms, disable CGI scanning and also disable web application testing.

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175200.png)

Then after configuring the those sections I saved the scan in the same folder with the previous scan which was the Host Discovery scan. To start the scan I clicked the launch button which is the play icon on the right next to the red cross.

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175404.png)

I clicked the scan to see if it is running and I could see it on the right at the Scan Details that the status says "Running".

![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175420.png)

After the scan was complete the scan showed that the was alot of Vulnerabilities where 68 of the vulnerabilities are Info and then the is 1 Low and 1 Medium. 

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20181825.png)

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20181806.png)

So at this point I wanted to see if I would do a basic network scan but now i provide nessus with the credentials to the windows 10 machine and also give permission what types of vulnerabilities would it find. So I had to follow stpes from Nessus to actually do the credential scans so i had to go to services.MSC on my windows 10 machine to start this process and enable Remote Registry. This will allow Nessus to connect to the VM's registry and properly scan for vulnerabilities such as insecure connections or deprecated cipher suites.

![Win Service](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20181430.png)

From there I had to go to User Account Controls and disable it. I had to do this because this Windows VM is not on a domain.

![Win User Account Controls](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20181556.png)

### _Basic Network Scan with Credentials Provided_

So after following the steps that was needed now I could do a basic network scan and provide nessus my credentials. I created a new scan and I selected the option "Basic Network Scan". The target stayed the same which was 192.168.64.132.

![Basic Network Scan Credentials Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20182007.png)

The Discovery section stayed the same as the previous basic network scan as I didnt need to change anything except provide the credentials.

![Basic Network Scan Credentials Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20182016.png)

Then went to the tab where it says credentials and provided the credentials and saved the scan. Then to start the scan I clicked the launch button which is the play icon on the right next to the red cross. So to see that the scan is running I clicked the scan and I saw on the right at scan details that the scan is running.

![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20182038.png)

After the scan was complete the was 304 vulnerabilities found 189 was Info, 3 was Low, 8 was Medium, 54 was High and 50 was critical and I went to see the critical vulnerabilities and High vulnerabilities as they are very important to focus on. 

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185528.png)
![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185546.png)
![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185601.png)

I also navigated to the remediation tab to see what they recommend us to do.

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185625.png)

I even exported a nessus report to get a complete list of vulnerabilities by the host. The document is the pdf called Basic Network Scan (with credentials provided).

![Export Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185721.png)

### _Remediation_

For the remediation I just went to the windows 10 and I checked for updates as this was a old version windows 10 and I saw the was a lot and most of them it is to patch the security vulnerabilities that was found by the scan. The Adobe Flash Player it is being removed, the .NET Framework is being updated and the windows 10 version being updated so this was already remediating the security vulnerabilities that were found.

![Win Remediation](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20190100.png)
![Win Remediation](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20190247.png)

After the updates were successful and now the it was up-to-date the machine. I wanted to run another basic network scan with the credentials after the remediation to so now how many vulnerabilities could be found.

![Successful Remediation](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20204910.png)

### _Basic Network Scan After Remediation Has Been Completed._

So now I created a new scan that was a basic network scan. The information I need to write was the same as the previous scans nothing has changed except for the name of this scan but the target is still the same. The next sections are all set to default nothing was changed and I also gave nessus my credentials.

![Basic Network Scan Credentials After Remediation Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20205306.png)
![Basic Network Scan Credentials After Remediation Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20205324.png)

I saved the scan and I launched it and I saw that after all the remediation that was done by updating the machine the was now less vulnerabilities they are even less than the first basic network scan.

![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20205531.png)
![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20210847.png)

Here is a final comparison between the three scans I took while doing this lab. The last picture is the after remediation scan. There we can see a lot of the vulnerabilities that were being alerted are gone! 
![Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-22%20010942.png)
