# Nessus-Vulnerability-Management-Lab

## Description

This is a walkthrough of how I created a virtual machine environment using VMware, running Windows 10 and Kali Linux. I undertook this project to gain hands-on experience with Nessus Essentials, focusing on host discovery, vulnerability scanning, and remediation. I first used Nessus to conduct a host discovery to identify which devices are active on the network. Then, I ran three basic network scans with different configurations:
- Normal Basic Network Scan.
- Basic Network Scan with Credentials Provided.
- Basic Network Scan After Remediation Has Been Completed.

## Environments Used
- VMware
- Kali Linux
- Windows 10

## Project Walkthrough
### _Host Discovery_
  
The first thing I wanted to do was discover which devices were active on the network and identify their IP addresses. While I could have simply checked the IP address of the Windows machine using the CMD and typing "ipconfig," I found it more enjoyable to use Nessus to locate the IPv4 address and identify the open ports on the device. So the first thing I click the button on the top right corner that says "New Scan".

![Homepage Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173256.png)

After clicking the button it navigated me to the Scan Templates. So here I clicked the option "Host Discovery" under the Discovery section.

![Scan Templates Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173321.png)

After clicking the option, I needed to fill in some information to run the scan. The required details included a name and the target. For the target, I entered a CIDR notation to reveal all active devices within that IP range, specifically from 192.168.64.0 to 192.168.64.255.

![Host Discovery Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173825.png)

Then I moved to the next section, which is Discovery, and I left it set to the default option, "Host Enumeration.". To determine if a device is active, it will ping it in three ways: TCP, ARP, and ICMP.

![Host Discovery Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173854.png)

After that I clicked the save button at the bottom to save the scan. To start the scan I clicked the launch button which is the play icon on the right next to the red cross.

![Host Discovery Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173951.png)

I clicked the scan to see if it is running and I could see it on the right at the Scan Details that the status says "Running".

![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20174018.png)

After the scan was done I went to the Host tab to see which hosts were active and I saw that the was 4 hosts active but IP 192.168.64.1 and 192.168.64.254 they could be a Gateway and a Router so it came down to the other two devices and I knew that the kali linux ip is 192.168.64.128 so the Windows IP address was 192.168.64.132 and also because of port 139 it confirms that it is a Windows as this port is primarily used by the Server Message Block (SMB) protocol for file sharing in Windows networks.

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20174302.png)

### _Normal Basic Network Scan_
  
Now that I have found the IP address for my Windows machine, I can begin the Basic Network scan to identify potential security vulnerabilities. I will create a new scan and choose the "Basic Network Scan" option. 

![Scan Templates Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20173321.png)

After clicking the option, I needed to fill in some information to run the scan, similar to the Host Discovery. However, this time, since I know my target, I simply specified the target IP address: 192.168.64.132. 

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20174847.png)

Then I moved to the next subsection, which is Schedule. If I were conducting this for an organization, I would set the scan to run every week on Sunday at 6 AM, so the schedule option would look like this.

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175040.png)

However, since I don't need to schedule the scan, I will revert to the default option, which is to disable the scheduling feature.

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175055.png)

Then, I moved to the next section, which is Discovery, and left it set to the default option, "Port scan (common ports)."

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175133.png)

After the Discovery section, I moved to the next section, which is Assessment. I left it set to the default option to avoid potential false alarms by disabling CGI scanning and web application testing.

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175200.png)

After configuring those sections, I saved the scan in the same folder as the previous scan, which was the Host Discovery scan. To start the scan, I clicked the launch button, represented by the play icon on the right, next to the red cross.

![Basic Network Scan Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175404.png)

I clicked on the scan to check if it was running, and I could see in the Scan Details on the right that the status indicated "Running."

![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20175420.png)

After the scan was complete, it revealed a significant number of vulnerabilities, with 68 classified as Info, and 1 categorized as Low and 1 as Medium.

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20181825.png)

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20181806.png)

At this point, I wanted to see what vulnerabilities a basic network scan would reveal if I provided Nessus with the credentials for the Windows 10 machine. To do this, I needed to follow the steps in Nessus for credentialed scans. First, I opened services.msc on my Windows 10 machine to enable Remote Registry. This allows Nessus to connect to the VM's registry and properly scan for vulnerabilities, such as insecure connections or deprecated cipher suites.

![Win Service](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20181430.png)

From there I had to go to User Account Controls and disable it. I had to do this because this Windows VM is not on a domain.

![Win User Account Controls](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20181556.png)

### _Basic Network Scan with Credentials Provided_

After completing the necessary steps, I was ready to perform a basic network scan and provide Nessus with my credentials. I created a new scan and selected the "Basic Network Scan" option. The target remained the same: 192.168.64.132.

![Basic Network Scan Credentials Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20182007.png)

The Discovery section remained the same as in the previous basic network scan, as I didn't need to change anything except to provide the credentials.

![Basic Network Scan Credentials Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20182016.png)

Next, I went to the Credentials tab and entered the necessary credentials before saving the scan. To start the scan, I clicked the launch button, represented by the play icon on the right, next to the red cross. To verify that the scan was running, I clicked on it and saw in the Scan Details on the right that the status indicated "Running."

![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20182038.png)

After the scan was complete, a total of 304 vulnerabilities were found: 189 were classified as Info, 3 as Low, 8 as Medium, 54 as High, and 50 as Critical. I focused on reviewing the Critical and High vulnerabilities, as they are the most important to address.

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185528.png)
![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185546.png)
![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185601.png)

I also navigated to the Remediation tab to see the recommended actions. It suggested that I remove Adobe Flash Player and update the .NET Framework.

![Scan Complete Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185625.png)

I also exported a Nessus report to obtain a complete list of vulnerabilities by host. The document is a PDF titled "Basic Network Scan (with credentials provided)."

![Export Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20185721.png)

### _Remediation_

For remediation, I went to my Windows 10 machine and checked for updates, as it was running an older version. I found a significant number of updates available, most of which were aimed at patching the security vulnerabilities identified by the scan. I proceeded to remove Adobe Flash Player, update the .NET Framework, and upgrade Windows 10. This process effectively addressed many of the security vulnerabilities that were found.

![Win Remediation](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20190100.png)
![Win Remediation](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20190247.png)

After the updates were successfully completed and the machine was up to date, I wanted to run another basic network scan with the credentials to see how many vulnerabilities remained after the remediation.

![Successful Remediation](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20204910.png)

### _Basic Network Scan After Remediation Has Been Completed._

I created a new scan, which was a basic network scan. The information I needed to provide was the same as in the previous scans; the only change was the name of this scan, while the target remained the same. All subsequent sections were set to default, and I also provided Nessus with my credentials.

![Basic Network Scan Credentials After Remediation Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20205306.png)
![Basic Network Scan Credentials After Remediation Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20205324.png)

I saved the scan and launched it. After all the remediation done by updating the machine, I saw that there were now fewer vulnerabilities—fewer than in the first basic network scan.

![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20205531.png)
![Scan Running Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-21%20210847.png)

Here is a final comparison between the three scans I conducted during this lab. The last image shows the post-remediation scan, where we can see that many of the previously critical and High identified vulnerabilities are no longer present!
![Nessus](https://github.com/ofentse579/Images/blob/main/Screenshot%202024-10-22%20010942.png)
